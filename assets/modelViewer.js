import"./modulepreload-polyfill.js";import{s as I,_ as L,j as U,M as k,k as v,r as B,g as D,w as E,z as O}from"./gltf-io.js";import{M as S}from"./manifold.js";const w=I(new L),e=new U,M=await S();M.setup();const{Manifold:i,Mesh:j}=M,f=new Map;async function R(o){const a=Array(),c=await w.read(o);await c.transform(k());const d=c.getRoot().listNodes(),g=Array();for(const t of d){v(t);const r=t.getMesh();if(r==null)continue;const s=B(r);if(s==null)continue;const m=s.runProperties.length,u=i.reserveIDs(m);s.mesh.runOriginalID=new Uint32Array(m);for(let n=0;n<m;++n)s.mesh.runOriginalID[n]=u+n,g.push(u+n),f.set(u+n,s.runProperties[n]);a.push(new i(new j(s.mesh)))}const y=e.getRoot().listMaterials().length;e.merge(c),e.getRoot().listScenes().forEach(t=>t.dispose()),e.getRoot().listBuffers().forEach(t=>t.dispose()),e.getRoot().listAccessors().forEach(t=>t.dispose());for(const[t,r]of g.entries()){const s=e.getRoot().listMaterials()[y+t];f.get(r).material=s}return i.union(a)}const A=await R("/models/space.glb"),q=await R("/models/moon.glb"),h=e.createNode();e.createScene().addChild(h);function b(o){P(i[o](A,q))}b("difference");const p=document.querySelector("select");p.onchange=function(){b(p.value)};let l="";const z=document.querySelector("#download");z.onclick=function(){const o=document.createElement("a");o.download="manifold.glb",o.href=l,o.click()};const N=document.querySelector("model-viewer");async function P(o){D(h.getMesh());const a=E(e,o.getMesh(),f);h.setMesh(a),await e.transform(O());const c=await w.writeBinary(e),d=new Blob([c],{type:"application/octet-stream"});URL.revokeObjectURL(l),l=URL.createObjectURL(d),N.src=l}
//# sourceMappingURL=modelViewer.js.map
