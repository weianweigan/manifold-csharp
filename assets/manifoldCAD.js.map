{"version":3,"file":"manifoldCAD.js","sources":["../../editor.js"],"sourcesContent":["// Copyright 2022 The Manifold Authors.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport ManifoldWorker from './worker-wrapper?worker';\n\nconst CODE_START = '<code>';\n// Loaded globally by examples.js\nconst exampleFunctions = self.examples.functionBodies;\n\nif (navigator.serviceWorker) {\n  navigator.serviceWorker.register(\n      '/service-worker.js', {scope: './index.html'});\n}\n\nlet editor = undefined;\n\n// Edit UI ------------------------------------------------------------\n\nconst undoButton = document.querySelector('#undo');\nconst redoButton = document.querySelector('#redo');\nconst formatButton = document.querySelector('#format');\nconst shareButton = document.querySelector('#share');\n\nundoButton.onclick = () => editor.trigger('ignored', 'undo');\nredoButton.onclick = () => editor.trigger('ignored', 'redo');\nformatButton.onclick = () =>\n    editor.trigger('ignored', 'editor.action.formatDocument');\nshareButton.onclick = () => {\n  const url = new URL(window.location.toString());\n  url.hash =\n      '#' +\n      encodeURIComponent(\n          currentFileElement.textContent + CODE_START + editor.getValue());\n  navigator.clipboard.writeText(url.toString());\n  console.log('Shareable link copied to clipboard!');\n  console.log('Consider shortening this URL using tinyURL.com');\n};\n\n// File UI ------------------------------------------------------------\nconst fileButton = document.querySelector('#file');\nconst currentFileElement = document.querySelector('#current');\nconst fileArrow = document.querySelector('#file .uparrow');\nconst fileDropdown = document.querySelector('#fileDropdown');\nconst saveContainer = document.querySelector('#save');\nconst saveDropdown = document.querySelector('#saveDropdown');\nconst saveArrow = document.querySelector('#save .uparrow');\n\nconst hideDropdown = function() {\n  fileDropdown.classList.remove('show');\n  saveDropdown.classList.remove('show');\n  fileArrow.classList.remove('down');\n  saveArrow.classList.remove('down');\n};\nconst toggleFileDropdown = function(event) {\n  event.stopPropagation();\n  fileDropdown.classList.toggle('show');\n  fileArrow.classList.toggle('down');\n};\nconst toggleSaveDropdown = function(event) {\n  event.stopPropagation();\n  saveDropdown.classList.toggle('show');\n  saveArrow.classList.toggle('down');\n};\nfileButton.onclick = toggleFileDropdown;\nsaveArrow.parentElement.onclick = toggleSaveDropdown;\ndocument.body.onclick = hideDropdown;\n\nconst prefix = 'ManifoldCAD';\nfunction getScript(name) {\n  return window.localStorage.getItem(prefix + name);\n}\nfunction setScript(name, code) {\n  window.localStorage.setItem(prefix + name, code);\n}\nfunction removeScript(name) {\n  window.localStorage.removeItem(prefix + name);\n}\nfunction nthKey(n) {\n  if (n >= window.localStorage.length) return;\n  const key = window.localStorage.key(n);\n  if (key.startsWith(prefix)) {\n    return key.slice(prefix.length);\n  }\n}\n\nfunction saveCurrent() {\n  if (editor) {\n    const currentName = currentFileElement.textContent;\n    if (!exampleFunctions.get(currentName)) {\n      setScript(currentName, editor.getValue());\n    }\n  }\n};\n\nwindow.onpagehide = saveCurrent;\nwindow.beforeunload = saveCurrent;\n\nlet switching = false;\nlet isExample = true;\nfunction switchTo(scriptName) {\n  if (editor) {\n    switching = true;\n    currentFileElement.textContent = scriptName;\n    setScript('currentName', scriptName);\n    isExample = exampleFunctions.get(scriptName) != null;\n    const code = isExample ? exampleFunctions.get(scriptName).substring(1) :\n                             getScript(scriptName) ?? '';\n    window.location.hash = '#' + scriptName;\n    editor.setValue(code);\n  }\n}\n\nfunction createDropdownItem(name) {\n  const container = document.createElement('div');\n  container.classList.add('item');\n  const button = document.createElement('button');\n  container.appendChild(button);\n  button.type = 'button';\n  button.classList.add('blue', 'item');\n  const label = document.createElement('span');\n  button.appendChild(label);\n  label.textContent = name;\n\n  button.onclick = function() {\n    saveCurrent();\n    switchTo(label.textContent);\n  };\n  // Stop text input spaces from triggering the button\n  button.onkeyup = function(event) {\n    event.preventDefault();\n  };\n  return button;\n}\n\nfunction addIcon(button) {\n  const icon = document.createElement('button');\n  icon.classList.add('icon');\n  button.parentElement.appendChild(icon);\n  return icon;\n}\n\nfunction uniqueName(name) {\n  let num = 1;\n  let newName = name;\n  while (getScript(newName) != null || exampleFunctions.get(newName) != null) {\n    newName = name + ' ' + num++;\n  }\n  return newName;\n}\n\nfunction addEdit(button) {\n  const label = button.firstChild;\n  const edit = addIcon(button);\n  edit.classList.add('edit');\n\n  edit.onclick = function(event) {\n    event.stopPropagation();\n    const oldName = label.textContent;\n    const code = getScript(oldName);\n    const form = document.createElement('form');\n    const inputElement = document.createElement('input');\n    inputElement.classList.add('name');\n    inputElement.value = oldName;\n    label.textContent = '';\n    button.appendChild(form);\n    form.appendChild(inputElement);\n    inputElement.focus();\n    inputElement.setSelectionRange(0, oldName.length);\n\n    function rename() {\n      const input = inputElement.value;\n      inputElement.blur();\n      if (!input) return;\n      const newName = uniqueName(input);\n      label.textContent = newName;\n      if (currentFileElement.textContent == oldName) {\n        currentFileElement.textContent = newName;\n      }\n      removeScript(oldName);\n      setScript(newName, code);\n    }\n\n    form.onsubmit = rename;\n    inputElement.onclick = function(event) {\n      event.stopPropagation();\n    };\n\n    inputElement.onblur = function() {\n      button.removeChild(form);\n      label.textContent = oldName;\n    };\n  };\n\n  const trash = addIcon(button);\n  trash.classList.add('trash');\n  let lastClick = 0;\n\n  trash.onclick = function(event) {\n    event.stopPropagation();\n    if (button.classList.contains('blue')) {\n      lastClick = performance.now();\n      button.classList.remove('blue');\n      button.classList.add('red');\n      document.body.addEventListener('click', function() {\n        button.classList.add('blue');\n        button.classList.remove('red');\n      }, {once: true});\n    } else if (performance.now() - lastClick > 500) {\n      removeScript(label.textContent);\n      if (currentFileElement.textContent == label.textContent) {\n        switchTo('Intro');\n      }\n      const container = button.parentElement;\n      container.parentElement.removeChild(container);\n    }\n  };\n}\n\nconst newButton = document.querySelector('#new');\nfunction newItem(code, scriptName = undefined) {\n  const name = uniqueName(scriptName ?? 'New Script');\n  setScript(name, code);\n  const nextButton = createDropdownItem(name);\n  newButton.insertAdjacentElement('afterend', nextButton.parentElement);\n  addEdit(nextButton);\n  return {button: nextButton, name};\n};\nnewButton.onclick = function() {\n  newItem('').button.click();\n};\n\nconst runButton = document.querySelector('#compile');\nconst poster = document.querySelector('#poster');\nlet manifoldInitialized = false;\nlet autoExecute = true;\n\nfunction initializeRun() {\n  runButton.disabled = false;\n  if (autoExecute) {\n    runButton.click();\n  } else {\n    poster.textContent = 'Auto-run disabled';\n  }\n}\n\n// Editor ------------------------------------------------------------\nlet tsWorker = undefined;\n\nasync function getManifoldDTS() {\n  const global = await fetch('/manifold-global-types.d.ts')\n                     .then(response => response.text());\n\n  const encapsulated = await fetch('/manifold-encapsulated-types.d.ts')\n                           .then(response => response.text());\n\n  return `\n${global.replaceAll('export', '')}\n${encapsulated.replace(/^import.*$/gm, '').replaceAll('export', 'declare')}\ndeclare interface ManifoldToplevel {\n  CrossSection: typeof T.CrossSection;\n  Manifold: typeof T.Manifold;\n  Mesh: typeof T.Mesh;\n  triangulate: typeof T.triangulate;\n  setMinCircularAngle: typeof T.setMinCircularAngle;\n  setMinCircularEdgeLength: typeof T.setMinCircularEdgeLength;\n  setCircularSegments: typeof T.setCircularSegments;\n  getCircularSegments: typeof T.getCircularSegments;\n  resetToCircularDefaults: typeof T.resetToCircularDefaults;\n  setup: () => void;\n}\ndeclare const module: ManifoldToplevel;\n`;\n}\n\nasync function getEditorDTS() {\n  const global = await fetch('/editor.d.ts').then(response => response.text());\n  return `${global.replace(/^import.*$/gm, '')}`;\n}\n\nrequire.config({\n  paths:\n      {vs: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.34.0/min/vs'}\n});\nrequire(['vs/editor/editor.main'], async function() {\n  monaco.languages.typescript.typescriptDefaults.addExtraLib(\n      await getManifoldDTS());\n  monaco.languages.typescript.typescriptDefaults.addExtraLib(\n      await getEditorDTS());\n  editor = monaco.editor.create(\n      document.getElementById('editor'),\n      {language: 'typescript', automaticLayout: true});\n  const w = await monaco.languages.typescript.getTypeScriptWorker();\n  tsWorker = await w(editor.getModel().uri);\n  editor.getModel().updateOptions({tabSize: 2});\n\n  for (const [name] of exampleFunctions) {\n    const button = createDropdownItem(name);\n    fileDropdown.appendChild(button.parentElement);\n  }\n\n  let currentName = currentFileElement.textContent;\n\n  for (let i = 0; i < window.localStorage.length; i++) {\n    const key = nthKey(i);\n    if (!key) continue;\n    if (key === 'currentName') {\n      currentName = getScript(key);\n    } else if (key === 'safe') {\n      autoExecute = getScript(key) !== 'false';\n    } else {\n      const button = createDropdownItem(key);\n      newButton.insertAdjacentElement('afterend', button.parentElement);\n      addEdit(button);\n    }\n  }\n\n  if (window.location.hash.length > 0) {\n    const fragment = decodeURIComponent(window.location.hash.substring(1));\n    const codeIdx = fragment.indexOf(CODE_START);\n    if (codeIdx != -1) {\n      autoExecute = true;\n      const name = fragment.substring(0, codeIdx);\n      switchTo(\n          newItem(fragment.substring(codeIdx + CODE_START.length), name).name);\n    } else {\n      if (fragment != currentName) {\n        autoExecute = true;\n      }\n      switchTo(fragment);\n    }\n  } else {\n    switchTo(currentName);\n  }\n\n  if (manifoldInitialized) {\n    initializeRun();\n  }\n\n  editor.onDidChangeModelContent(e => {\n    runButton.disabled = false;\n    if (switching) {\n      switching = false;\n      editor.setScrollTop(0);\n      return;\n    }\n    if (isExample) {\n      const cursor = editor.getPosition();\n      newItem(editor.getValue()).button.click();\n      editor.setPosition(cursor);\n    }\n  });\n\n  window.onresize = () => {\n    editor.layout({});\n  };\n});\n\n// Animation ------------------------------------------------------------\nconst mv = document.querySelector('model-viewer');\nconst animationContainer = document.querySelector('#animation');\nconst playButton = document.querySelector('#play');\nconst scrubber = document.querySelector('#scrubber');\nlet paused = false;\n\nmv.addEventListener('load', () => {\n  const hasAnimation = mv.availableAnimations.length > 0;\n  animationContainer.style.display = hasAnimation ? 'flex' : 'none';\n  if (hasAnimation) {\n    play();\n  }\n});\n\nfunction play() {\n  mv.play();\n  playButton.classList.remove('play');\n  playButton.classList.add('pause');\n  paused = false;\n  scrubber.classList.add('hide');\n}\n\nfunction pause() {\n  mv.pause();\n  playButton.classList.remove('pause');\n  playButton.classList.add('play');\n  paused = true;\n  scrubber.max = mv.duration;\n  scrubber.value = mv.currentTime;\n  scrubber.classList.remove('hide');\n}\n\nplayButton.onclick = function() {\n  if (paused) {\n    play();\n  } else {\n    pause();\n  }\n};\n\nscrubber.oninput = function() {\n  mv.currentTime = scrubber.value;\n};\n\n// Execution ------------------------------------------------------------\nconst consoleElement = document.querySelector('#console');\nconst oldLog = console.log;\nconsole.log = function(message) {\n  consoleElement.textContent += message + '\\r\\n';\n  consoleElement.scrollTop = consoleElement.scrollHeight;\n  oldLog(message);\n};\n\nfunction clearConsole() {\n  consoleElement.textContent = '';\n}\n\nfunction enableCancel() {\n  runButton.firstChild.style.visibility = 'hidden';\n  runButton.classList.add('red', 'cancel');\n}\n\nfunction disableCancel() {\n  runButton.firstChild.style.visibility = 'visible';\n  runButton.classList.remove('red', 'cancel');\n}\n\nlet t0 = performance.now();\n\nfunction finishRun() {\n  disableCancel();\n  const t1 = performance.now();\n  const log = consoleElement.textContent;\n  // Remove \"Running...\"\n  consoleElement.textContent = log.substring(log.indexOf('\\n') + 1);\n  console.log(\n      `Took ${(Math.round((t1 - t0) / 10) / 100).toLocaleString()} seconds`);\n}\n\nconst output = {\n  glbURL: null,\n  threeMFURL: null\n};\nlet manifoldWorker = null;\n\nfunction createWorker() {\n  manifoldWorker = new ManifoldWorker();\n  manifoldWorker.onmessage = function(e) {\n    if (e.data == null) {\n      if (tsWorker != null && !manifoldInitialized) {\n        initializeRun();\n      }\n      manifoldInitialized = true;\n      return;\n    }\n\n    if (e.data.log != null) {\n      consoleElement.textContent += e.data.log + '\\r\\n';\n      consoleElement.scrollTop = consoleElement.scrollHeight;\n      return;\n    }\n\n    finishRun();\n    runButton.disabled = true;\n\n    if (output.threeMFURL != null) {\n      URL.revokeObjectURL(output.threeMFURL);\n      output.threeMFURL = null;\n    }\n    URL.revokeObjectURL(output.glbURL);\n    output.glbURL = e.data.glbURL;\n    output.threeMFURL = e.data.threeMFURL;\n    threemfButton.disabled = output.threeMFURL == null;\n    mv.src = output.glbURL;\n    if (output.glbURL == null) {\n      mv.showPoster();\n      poster.textContent = 'Error';\n      createWorker();\n    } else {\n      setScript('safe', 'true');\n    }\n  }\n}\n\ncreateWorker();\n\nasync function run() {\n  saveCurrent();\n  setScript('safe', 'false');\n  enableCancel();\n  clearConsole();\n  console.log('Running...');\n  const output = await tsWorker.getEmitOutput(editor.getModel().uri.toString());\n  manifoldWorker.postMessage(output.outputFiles[0].text);\n  t0 = performance.now();\n}\n\nfunction cancel() {\n  manifoldWorker.terminate();\n  createWorker();\n  finishRun();\n  console.log('Run canceled');\n}\n\nrunButton.onclick = function() {\n  if (runButton.classList.contains('cancel')) {\n    cancel();\n  } else {\n    run();\n  }\n};\n\nfunction clickSave(saveButton, filename, outputName) {\n  const container = saveButton.parentElement;\n  return () => {\n    const oldSave = saveContainer.firstElementChild;\n    if (oldSave !== container) {\n      saveDropdown.insertBefore(oldSave, saveDropdown.firstElementChild);\n      saveContainer.insertBefore(container, saveDropdown);\n      container.appendChild(saveArrow.parentElement);\n    }\n    const link = document.createElement('a');\n    link.download = filename;\n    link.href = output[outputName];\n    link.click();\n  };\n}\n\nconst glbButton = document.querySelector('#glb');\nglbButton.onclick = clickSave(glbButton, 'manifold.glb', 'glbURL');\n\nconst threemfButton = document.querySelector('#threemf');\nthreemfButton.onclick = clickSave(threemfButton, 'manifold.3mf', 'threeMFURL');\n"],"names":["CODE_START","exampleFunctions","editor","undoButton","redoButton","formatButton","shareButton","url","currentFileElement","fileButton","fileArrow","fileDropdown","saveContainer","saveDropdown","saveArrow","hideDropdown","toggleFileDropdown","event","toggleSaveDropdown","prefix","getScript","name","setScript","code","removeScript","nthKey","n","key","saveCurrent","currentName","switching","isExample","switchTo","scriptName","createDropdownItem","container","button","label","addIcon","icon","uniqueName","num","newName","addEdit","edit","oldName","form","inputElement","rename","input","trash","lastClick","newButton","newItem","nextButton","runButton","poster","manifoldInitialized","autoExecute","initializeRun","tsWorker","getManifoldDTS","global","response","encapsulated","getEditorDTS","i","fragment","codeIdx","e","cursor","mv","animationContainer","playButton","scrubber","paused","hasAnimation","play","pause","consoleElement","oldLog","message","clearConsole","enableCancel","disableCancel","t0","finishRun","t1","log","output","manifoldWorker","createWorker","ManifoldWorker","threemfButton","run","cancel","clickSave","saveButton","filename","outputName","oldSave","link","glbButton"],"mappings":"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"}